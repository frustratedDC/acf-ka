<!DOCTYPE html>
<html>
<head>
    <title>ACF Keeping Active — Attendance</title>
    <link rel="stylesheet" href="style.css">

    <script>
        let cadetMasterList = JSON.parse(localStorage.getItem("cadetMasterList")) || [];

        function loadCadets() {
            const list = document.getElementById("cadetList");
            list.innerHTML = "";

            cadetMasterList.forEach(cadet => {
                list.insertAdjacentHTML("beforeend", `
                    <label class="cadet-row">
                        <input type="checkbox" id="cadet_${cadet.id}">
                        ${cadet.firstname} ${cadet.surname}
                    </label>
                `);
            });
        }

        function saveAttendance() {
            const attending = [];

            cadetMasterList.forEach(cadet => {
                if (document.getElementById(`cadet_${cadet.id}`).checked) {
                    attending.push({
                        id: cadet.id,
                        firstname: cadet.firstname,
                        surname: cadet.surname
                    });
                }
            });

            if (attending.length === 0) {
                alert("Select at least one cadet.");
                return;
            }

            const session = {
                timestamp: new Date().toISOString().split("T")[0],
                det: "Your Detachment",
                attending,
                scores: {}
            };

            localStorage.setItem("current_session", JSON.stringify(session));
            window.location.href = "scores.html";
        }

        window.onload = loadCadets;
    </script>
</head>

<body>

<div class="ka-header">ACF Keeping Active — Attendance</div>

<h2 class="page-title">Select Cadets Present</h2>

<div id="cadetList" class="section-box"></div>

<button class="btn btn-primary" onclick="saveAttendance()">Continue →</button>

</body>
</html>