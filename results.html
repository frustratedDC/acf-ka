<!DOCTYPE html>
<html>
<head>
    <title>ACF Keeping Active — Results</title>
    <link rel="stylesheet" href="style.css">

    <script>
        /* ============================================================
           LOAD DATA
        ============================================================ */
        let sessionHistory = JSON.parse(localStorage.getItem("sessionHistory")) || [];
        let cadetMasterList = JSON.parse(localStorage.getItem("cadetMasterList")) || [];

        if (sessionHistory.length === 0) {
            alert("No session results found. Returning to attendance page.");
            window.location.href = "attendance.html";
        }

        const latestSession = sessionHistory[sessionHistory.length - 1];

        /* ============================================================
           BUILD RESULTS TABLE
        ============================================================ */
        function loadResults() {
            const table = document.getElementById("resultsTable");

            table.innerHTML = `
                <tr>
                    <th>Surname</th>
                    <th>First Name</th>
                    <th>Present</th>
                    <th>Score</th>
                </tr>
            `;

            latestSession.results.forEach(r => {
                table.insertAdjacentHTML("beforeend", `
                    <tr>
                        <td>${r.surname}</td>
                        <td>${r.firstname}</td>
                        <td>${r.present}</td>
                        <td>${r.present === "Yes" ? r.score : "-"}</td>
                    </tr>
                `);
            });
        }

        window.onload = loadResults;
    </script>
</head>

<body>

    <div class="ka-header">ACF Keeping Active — Results</div>

    <h2 class="page-title">Session Results</h2>

    <div class="section-box">
        <p><strong>Date:</strong> ${latestSession.date}</p>
        <p><strong>Detachment:</strong> ${latestSession.det}</p>
    </div>

    <table id="resultsTable"></table>

    <button class="btn btn-primary" onclick="location.href='progression.html'">View Progression →</button>
    <button class="btn btn-secondary" onclick="location.href='admin.html'">Return to Admin</button>

</body>
</html>